出典: フリー百科事典『ウィキペディア（Wikipedia）』 移動: ナビゲーション, 検索 自己回帰移動平均モデル（じこかいきいどうへいきんモデル、英: Autoregressive moving average model、ARMAモデル）は、統計学において時系列データに適用されるモデルである。George Box と G. M. Jenkins の名をとって "ボックス・ジェンキンスモデル" とも呼ばれる。時系列データ Xt について、ARMAモデルはその将来の値を予測するためのツールとして機能する。モデルは自己回帰(AR)部分と移動平均(MA)部分からなる。一般に ARMA(p,q)モデルと表記され、p は自己回帰部分の次数、q は移動平均部分の次数を表す（定義は後述）。目次 1 自己回帰モデル1.1 例: AR(1)過程1.2 ARパラメータの計算1.2.1 導出    2 移動平均モデル3 自己回帰移動平均モデル4 誤差項5 ラグ（遅れ）作用素を使った記法6 実データへの適用7 一般化8 関連項目9 参考文献    [編集] 自己回帰モデルAR(p) という表記は次数 p の自己回帰モデルを表す。AR(p)モデルは次の式で表される。 ここではモデルのパラメータ、c は定数項、 は誤差項（後述）である。定数項は単純化するために省かれることが多い。自己回帰モデルは基本的に無限インパルス応答フィルタに一種の変形を加えたものである。モデルとして定常的であるために、パラメータの値には何らかの制約が必要である。例えば、|φ1| > 1 となる AR(1)モデルは定常的ではない。[編集] 例: AR(1)過程AR(1)過程は次の式で表される。 ここで、 は、σ2の分散に従うホワイトノイズである（ のような添え字は省いてある）。この過程は  であれば、共分散定常性を有する。 であれば、Xt は単位根を表し、ランダムウォークと見なされ、共分散定常性を有しない。そうでない場合、Xt の期待値の計算は単純である。ここで共分散定常性を以下のように定式化する。 従って、次のようになる。 ここで μ は平均である。c = 0 なら、平均も 0 になり、分散は次のようになる。 自己共分散は次の式で表される。 この自己共分散関数は減衰時間  で減衰する（これを確かめるには、Bn = Kφ | n | で K が n に独立な場合を考えればよい。φ | n | = e | n | lnφ であり、指数関数的減衰の法則 e − n / τ に適合することに注意されたい）。スペクトル密度関数は自己共分散関数の逆フーリエ変換である。離散系では、離散時間逆フーリエ変換が適用される。 Xj が離散的であるため、この式の分母にあるコサインの項が折り返し雑音（エイリアス）を表している。標本化間隔(Δt = 1)が減衰時間(τ)より十分に小さいと仮定すると、Bn に連続体近似を適用できる。 この場合、スペクトル密度はローレンツ分布に従う。 ここで γ = 1 / τ は減衰時間 τ に関する角周波数である。Xt の別の表現方法として、最初の式で Xt − 1 を  に置き換える方法がある。これを再帰的に N回繰り返すと次の式になる。 N が無限大に近づくと、 はゼロに近づき、最終的に次の式が得られる。 [編集] ARパラメータの計算AR(p)モデルは次の方程式で与えられる。 これはパラメータ （i = 1, ..., p）に基づいている。これらパラメータは以下の Yule-Walker方程式で計算できる可能性がある。 ここで m = 0, ... , p であり、p 個の方程式となる。γm は X の自己共分散関数、 は入力ノイズ過程の標準偏差、δm はクロネッカーのデルタである。この式の最後の部分は m = 0 のときだけ 0 でない値となるので、この方程式は一般に m > 0 のときの行列式で表すことで解ける。 これにより  が全て求められる。また、m = 0 のときは次のようになる。 これにより  が求められる。[編集] 導出AR過程を定義する方程式は次の通りである。 両辺に Xt-m をかけて、期待値を求めるとしたとき、次のようになる。 自己共分散関数の定義から、E[XtXt − m] = γm である。ノイズ関数の値は互いに独立であり、ゼロより大きい m について Xt は εt に独立である。m ≠ 0 の場合、 となる。m = 0 の場合、次のようになる。 従って、次が得られる。 さらに これにより次の Yule-Walker方程式が導かれる。 [編集] 移動平均モデルMA(q)という表記は、次数 q の移動平均モデルを表す。以下の数式で表される。 ここで θ1, ..., θq はモデルのパラメータ、εt, εt-1,... は誤差項である。移動平均モデルも無限インパルス応答フィルタに一種の変形を加えたものである。[編集] 自己回帰移動平均モデルARMA(p, q)という表記は、p次の自己回帰とq次の移動平均を組合わせたモデルを指す。以下の数式で表される。 [編集] 誤差項誤差項 εt は一般に「独立かつ同一の分布に従う」(i.i.d.)無作為変数であり、ゼロを平均値とする正規分布に従う。すなわち εt ~ N(0,σ2) で、σ2 は分散である。このような仮定を弱めることもあるが、そうするとモデルとしての性質が変化する。特に、i.i.d. という仮定を変更すると根本的な性質が変化する。[編集] ラグ（遅れ）作用素を使った記法ARMAモデルをラグ作用素（遅れ作用素） L を使って表す場合もある。この場合、AR(p)モデルは次のように表される。 ここで、φ は次の多項式で表される。 また、MA(q)モデルは次のように表される。 ここで θ は次の多項式で表される。 以上から、ARMA(p, q)モデルは次のように表される。 あるいは、もっと簡潔に記せば、次のようになる。 ラグ作用素とは、時系列データのある時点のデータで他の時点のデータを表すように係数化したもの。上記の式はいずれも Xt しか出現しない（他の時点のデータが出てこない）ことに注意されたい。他の時点のデータは全てラグ作用素によって表されている。[編集] 実データへの適用実データに適用する場合、ARMAモデルの p と q を選択後、誤差項を最小化するパラメータを探るため最小二乗法を使うのが普通である。また、実データに適合する最小の p および q を見つけることでよい結果が得られることが知られている。純粋なARモデルでは、これに Yule-Walker 方程式を利用することができる。[編集] 一般化Xt の過去の値や誤差項 εt との依存関係は特に何かが判明するまで線形な関係であると見なすのが普通である。依存関係が非線形である場合、このモデルを「非線形移動平均」(NMA)、「非線形自己回帰」(NAR)、「非線型自己回帰移動平均」(NARMA)モデルと呼ぶ。自己回帰移動平均モデルは他の方法でも一般化される。例えば、ARCH（自己回帰条件付き分散変動）モデルやARIMA（自己回帰和分移動平均）モデルがある。複数の時系列を扱うベクトルARIMAモデルもある。データに季節変動効果がある場合、SARIMA（季節ARIMA）モデルでモデル化される。その他の一般化として、「多変量自己回帰」(MAR)モデルがある。[編集] 関連項目自己回帰和分移動平均モデル予測分析放射基底関数 [編集] 参考文献George Box and Gwilym M. Jenkins. Time Series Analysis: Forecasting and Control, second edition. Oakland, CA: Holden-Day, 1976.Mills, Terence C. Time Series Techniques for Economists. Cambridge University Press, 1990.Percival, Donald B. and Andrew T. Walden. Spectral Analysis for Physical Applications. Cambridge University Press, 1993.  「http://ja.wikipedia.org/wiki/%E8%87%AA%E5%B7%B1%E5%9B%9E%E5%B8%B0%E7%A7%BB%E5%8B%95%E5%B9%B3%E5%9D%87%E3%83%A2%E3%83%87%E3%83%AB」より作成カテゴリ: ノイズ | 計量経済学 | 確率論 | 統計学 | 時系列分析 | 数学に関する記事 